<div
	id="first-viewer"
   style="position: absolute; transition-property: transform;"
	class="d-flex theme-background-color-primary"
	[style.width.px]="width"
	[style.height.px]="height"
	[style.z-index]="firstViewer.zIndex"
	[style.transform]="'translateX(' + firstViewer.positionLeft + 'px)'"
	[style.transitionDuration]="firstViewer.transitionTime + 'ms'">

	<iframe id="first-viewer-left" scrolling="no" style="border: none; position: relative; margin-top: 60px" [style.width.px]="firstViewer.left.width" [style.height.px]="firstViewer.left.height"></iframe>
	<iframe id="first-viewer-right" scrolling="no" style="border: none; position: relative; margin-top: 60px; right: 0" [style.width.px]="firstViewer.right.width" [style.height.px]="firstViewer.right.height"></iframe>
</div>

<div id="second-viewer"
	style="position: absolute; transition-property: transform;"
	class="d-flex theme-background-color-primary"
	[style.width.px]="width"
	[style.height.px]="height"
	[style.z-index]="secondViewer.zIndex"
	[style.transform]="'translateX(' + secondViewer.positionLeft + 'px)'"
	[style.transitionDuration]="secondViewer.transitionTime + 'ms'">

	<iframe id="second-viewer-left" scrolling="no" style="border: none; position: relative; margin-top: 60px" [style.width.px]="firstViewer.left.width" [style.height.px]="secondViewer.left.height"></iframe>
	<iframe id="second-viewer-right" scrolling="no" style="border: none; position: relative; margin-top: 60px; right: 0" [style.width.px]="firstViewer.right.width" [style.height.px]="secondViewer.right.height"></iframe>
</div>

<div id="third-viewer"
	style="position: absolute; transition-property: transform;"
	class="d-flex theme-background-color-primary"
	[style.width.px]="width"
	[style.height.px]="height"
	[style.z-index]="thirdViewer.zIndex"
	[style.transform]="'translateX(' + thirdViewer.positionLeft + 'px)'"
	[style.transitionDuration]="thirdViewer.transitionTime + 'ms'">

	<iframe id="third-viewer-left" scrolling="no" style="border: none; position: relative; margin-top: 60px" [style.width.px]="firstViewer.left.width" [style.height.px]="thirdViewer.left.height"></iframe>
	<iframe id="third-viewer-right" scrolling="no" style="border: none; position: relative; margin-top: 60px; right: 0" [style.width.px]="firstViewer.right.width" [style.height.px]="thirdViewer.right.height"></iframe>
</div>

<!-- Arrow buttons -->
<button mat-button 
	class="book-toolbar-button text-color" 
	style="position: absolute; width: 40px; left: 0; top: 0px; z-index: 2" 
	[style.marginTop.px]="showBottomToolbar ? 0 : 40"
	[style.height.px]="showBottomToolbar ? height : height - 40" 
	(click)="PrevPage()" 
	*ngIf="!firstPage && !showBottomToolbar">

	<i class="ms-Icon ms-Icon--ChevronLeft" aria-hidden="true"></i>
</button>
<button mat-button 
	class="book-toolbar-button text-color" 
	style="position: absolute; width: 40px; right: 0; top: 0px; z-index: 2" 
	[style.marginTop.px]="showBottomToolbar ? 0 : 40"
	[style.height.px]="showBottomToolbar ? height : height - 40" 
	(click)="NextPage()" 
	*ngIf="!showBottomToolbar">

	<i class="ms-Icon ms-Icon--ChevronRight" aria-hidden="true"></i>
</button>

<!-- Chapter title -->
<div
	style="position: absolute; bottom: 0; right: 0; height: 50px"
	class="d-flex justify-content-center"
	[ngClass]="dualScreenLayout ? 'w-50' : 'w-100'"
	*ngIf="!showBottomToolbar">

	<p class="align-self-center font-weight-light text-color"
		style="display: inline-block; margin: 0; font-size: 14px">
		{{ currentChapterTitle }}
	</p>
</div>

<!-- Top Toolbar -->
<div class="w-100" style="z-index: 2; position: absolute" *ngIf="!showBottomToolbar && initialized">
	<!-- Back button -->
	<button
		mat-button
		class="book-toolbar-button text-color" 
		style="font-size: 16px"
		[disabled]="navigationHistory.length == 0"
		(click)="GoBack()">

		<i class="ms-Icon ms-Icon--Back" aria-hidden="true"></i>
	</button>

	<!-- Home button -->
	<button
		mat-button
		class="book-toolbar-button text-color"
		(click)="GoHome()">

		<i class="ms-Icon ms-Icon--Home" aria-hidden="true"></i>
	</button>

	<div class="d-flex" style="float: right">
		<div
			class="d-flex justify-content-center align-items-center"
			style="width: 40px; height: 40px">

			<mat-progress-spinner
				[style.display]="progressRingVisible ? '' : 'none'"
				mode="indeterminate"
				diameter="18"
				strokeWidth="1.3">
			</mat-progress-spinner>
		</div>
		<button mat-button class="book-toolbar-button text-color" (click)="AddOrRemoveBookmark()">
			<i class="ms-Icon" [ngClass]="currentPageBookmark ? 'ms-Icon--SingleBookmarkSolid' : 'ms-Icon--AddBookmark'" aria-hidden="true"></i>
		</button>
		<button mat-button class="book-toolbar-button text-color" (click)="showBookmarksPanel = true">
			<i class="ms-Icon ms-Icon--DoubleBookmark" aria-hidden="true"></i>
		</button>
		<button mat-button class="book-toolbar-button text-color" (click)="showChaptersPanel = true">
			<i class="ms-Icon ms-Icon--BulletedList" aria-hidden="true"></i>
		</button>
	</div>
</div>

<!-- Bottom toolbar -->
<div class="w-100 d-flex justify-content-center"
	style="z-index: 2; position: fixed; bottom: 0;"
	[style.marginBottom.px]="bottomToolbarMarginBottom"
	[style.transition]="'all ' + bottomToolbarTransitionTime + 'ms'"
	*ngIf="showBottomToolbar && initialized">
	
	<div class="w-100" style="display: inline-block;">
		<div class="d-flex justify-content-center">
			<button mat-button class="book-toolbar-button text-color" style="font-size: 14px" (click)="OpenOrCloseBottomToolbar()">
				<i class="ms-Icon" [ngClass]="bottomToolbarOpened ? 'ms-Icon--ChevronDownMed' : 'ms-Icon--ChevronUpMed'" aria-hidden="true"></i>
			</button>
		</div>
		<div class="w-100 d-flex">
			<div style="position: absolute">
				<button
					mat-button
					class="book-toolbar-button text-color"
					style="font-size: 16px"
					[disabled]="navigationHistory.length == 0"
					(click)="GoBack()">
					
					<i class="ms-Icon ms-Icon--Back" aria-hidden="true"></i>
				</button>
	
				<button
					mat-button
					class="book-toolbar-button text-color"
					(click)="GoHome()">

					<i class="ms-Icon ms-Icon--Home" aria-hidden="true"></i>
				</button>
			</div>

			<div class="mx-auto">
				<button mat-button class="book-toolbar-button text-color" (click)="showChaptersPanel = true">
					<i class="ms-Icon ms-Icon--BulletedList" aria-hidden="true"></i>
				</button>
				<button mat-button class="book-toolbar-button text-color" (click)="showBookmarksPanel = true">
					<i class="ms-Icon ms-Icon--DoubleBookmark" aria-hidden="true"></i>
				</button>
				<button mat-button class="book-toolbar-button text-color" (click)="AddOrRemoveBookmark()">
					<i class="ms-Icon" [ngClass]="currentPageBookmark ? 'ms-Icon--SingleBookmarkSolid' : 'ms-Icon--AddBookmark'" aria-hidden="true"></i>
				</button>
			</div>
		</div>
	</div>
</div>

<!-- Total progress -->
<div
	style="position: absolute; bottom: 0; width: 2px; transition-duration: 400ms"
	[style.borderTop]="dataService.darkTheme ? '2px solid #b9b9b9' : '4px solid #7b7b7b'"
	[style.transform]="'scaleX(' + width * totalProgress + ')'">
</div>

<!-- Progress ring for small window -->
<div
	class="d-flex justify-content-center align-items-center"
	style="position: absolute; bottom: 0; right: 0; width: 40px; height: 40px"
	[style.visibility]="showBottomToolbar ? '' : 'hidden'">

	<mat-progress-spinner
		[style.display]="progressRingVisible ? '' : 'none'"
		mode="indeterminate"
		diameter="18"
		strokeWidth="1.3">
	</mat-progress-spinner>
</div>

<!-- Panel for Bookmarks -->
<dav-panel
	[header]="locale.bookmarks"
	[isVisible]="showBookmarksPanel"
	(dismiss)="CloseBookmarksPanel()">

	<ul class="list-group list-group-flush">
		<li class="list-group-item d-flex theme-background-color-secondary"
			style="padding: 5px 0px; margin-left: 20px; border: none; min-height: 35px; font-size: 16px"
			*ngFor="let bookmark of currentBook.bookmarks">
			<a href="#" class="text-color" (click)="NavigateToBookmark(bookmark)" [ngClass]="bookmark.uuid == currentPageBookmark ? 'font-weight-bold' : ''">
				{{ bookmark.name }}
			</a>
		</li>
	</ul>

	<p class="font-weight-light text-color"
		[style.display]="currentBook.bookmarks.length == 0 ? '' : 'none'">
		{{ locale.noBookmarks }}
	</p>
</dav-panel>

<!-- Panel for TOC -->
<dav-panel
	[header]="locale.toc"
	[isVisible]="showChaptersPanel"
	(dismiss)="CloseChaptersPanel()">

	<pocketlib-chapters-tree
		#chaptersTree
		[style.display]="showChaptersPanel ? '' : 'none'"
		(linkClick)="ChapterLinkClicked($event)">
	</pocketlib-chapters-tree>
</dav-panel>