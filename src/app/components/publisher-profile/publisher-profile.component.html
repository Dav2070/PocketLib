<div
	class="container ms-motion-slideUpIn"
	[style.paddingBottom.px]="dataService.bottomToolbarVisible && !storeContext ? 56 : 0">

	<div class="row">
		<div class="col-10 offset-1 col-md-4 offset-md-0 col-xl-3 text-center pt-5">
			<pocketlib-blurhash-image
				[src]="logoContent"
				[fallback]="dataService.defaultProfileImageUrl"
				[blurhash]="publisher.logo?.blurhash"
				[title]="publisher.name"
				[alt]="logoAlt"
				[width]="logoWidth"
				[height]="logoWidth"
				margin="0 0 1rem 0"
				shadow="true"
				rounded="true"
				[loading]="logoLoading">
			</pocketlib-blurhash-image>
			<br>

			<dav-button
				type="accent"
				ngxFilePicker
				accept="image/png,image/jpeg"
				[disabled]="logoLoading"
				(filePick)="LogoFileSelected($event)"
				*ngIf="publisherMode != 0">
				{{ locale.uploadLogo }}
			</dav-button>

			<h4 class="d-flex justify-content-center mt-3 text-color">
				{{ publisher.name }}

				<button
					type="button"
					class="d-flex align-items-center btn ms-2 text-color theme-background-color-primary theme-border-color-primary icon-button"
					style="height: 32px; font-size: 17px; margin-top: -4px; padding: 0px 4px"
					(click)="ShowEditProfileDialog()"
					*ngIf="publisherMode > 0">
					<i class="ms-Icon ms-Icon--Edit" style="font-size: 17px" aria-hidden="true"></i>
				</button>
			</h4>

			<div
				class="d-flex justify-content-center"
				*ngIf="publisher.websiteUrl || publisher.facebookUsername || publisher.instagramUsername || publisher.twitterUsername">

				<!-- Website -->
				<pocketlib-link-icon-button
					[icon]="faGlobe"
					[link]="publisher.websiteUrl"
					*ngIf="publisher.websiteUrl">
				</pocketlib-link-icon-button>

				<!-- Facebook -->
				<pocketlib-link-icon-button
					[icon]="faFacebook"
					[link]="facebookLink"
					*ngIf="publisher.facebookUsername">
				</pocketlib-link-icon-button>

				<!-- Instagram -->
				<pocketlib-link-icon-button
					[icon]="faInstagram"
					[link]="instagramLink"
					*ngIf="publisher.instagramUsername">
				</pocketlib-link-icon-button>

				<!-- Twitter -->
				<pocketlib-link-icon-button
					[icon]="faTwitter"
					[link]="twitterLink"
					*ngIf="publisher.twitterUsername">
				</pocketlib-link-icon-button>
			</div>

			<p class="mt-3 text-color"
				style="white-space: pre-line; text-align: justify"
				*ngIf="!editDescription">
				{{ publisher.description }}
			</p>

			<p class="mt-3 fw-light fst-italic text-color"
				*ngIf="(publisher.description == null || publisher.description.length == 0) && !editDescription">
				{{ locale.noDescription }}
			</p>

			<div class="mx-auto my-3" style="width: 80%" *ngIf="editDescription">
				<dav-textarea
					[value]="newDescription"
					[placeholder]="locale.descriptionTextareaPlaceholder"
					[disabled]="descriptionLoading"
					resize="vertical"
					[errorMessage]="newDescriptionError"
					(change)="newDescription = $event.detail.value; newDescriptionError = ''">
				</dav-textarea>
			</div>

			<dav-button
				type="accent"
				[disabled]="descriptionLoading"
				(click)="EditDescription()"
				*ngIf="publisherMode != 0">
				{{ editDescription ? locale.save : locale.edit }}
			</dav-button>

			<dav-button
				style="margin-left: 10px"
				[disabled]="descriptionLoading"
				(click)="CancelEditDescription()"
				*ngIf="editDescription">
				{{ locale.cancel }}
			</dav-button>
		</div>

		<div class="col-12 col-md-6 pt-3 mx-auto">
			<!-- Error message -->
			<div
				class="mt-3 mx-auto"
				style="min-width: 200px; max-width: 300px"
				*ngIf="errorMessage.length > 0 && publisherMode != 0">

				<dav-message-bar type="danger">
					{{ errorMessage }}
				</dav-message-bar>
			</div>

			<!-- List of authors for publishers / admins -->
			<h3 class="text-center text-color fw-light mb-3 mt-4" *ngIf="publisherMode != 0">
				{{ locale.yourAuthors }}
			</h3>

			<div class="mt-3" *ngIf="publisherMode != 0 && !authorsLoaded">
				<dav-progress-ring
					class="mx-auto"
					style="width: 28px; height: 28px">
				</dav-progress-ring>
			</div>

			<div *ngIf="authorsLoaded">
				<pocketlib-add-list-item
					(click)="ShowCreateAuthorDialog()"
					*ngIf="publisherMode != 0">
				</pocketlib-add-list-item>

				<a class="card cursor my-4 theme-background-color-secondary"
					style="text-decoration: none; transition: 0.12s"
					[ngClass]="hoveredAuthorItem == i ? 'shadow' : 'shadow-sm'"
					[routerLink]="publisherMode == 0 ? ('/store/author/' + author.uuid) : ('/author/' + author.uuid)"
					(mouseover)="hoveredAuthorItem = i"
					(mouseout)="hoveredAuthorItem = -1"
					(focusin)="hoveredAuthorItem = i"
					(focusout)="hoveredAuthorItem = -1"
					*ngFor="let author of authorItems; let i = index">

					<div class="card-body d-flex">
						<pocketlib-blurhash-image
							[src]="author.profileImageContent"
							[fallback]="dataService.defaultProfileImageUrl"
							[blurhash]="author.profileImageBlurhash"
							[title]="author.firstName + ' ' + author.lastName"
							[alt]="author.profileImageAlt"
							width="80"
							height="80"
							rounded="true">
						</pocketlib-blurhash-image>

						<h4 class="card-title ms-4 my-auto text-color fw-light">{{ author.firstName }} {{ author.lastName }}</h4>
					</div>
				</a>
			</div>
		</div>
	</div>
</div>

<dav-dialog
	[header]="locale.logoDialog.header"
	[primaryButtonText]="locale.save"
	[defaultButtonText]="locale.cancel"
	[visible]="logoDialogVisible"
	(dismiss)="logoDialogVisible = false"
	(primaryButtonClick)="UploadLogo()"
	(defaultButtonClick)="logoDialogVisible = false">

	<div class="mb-3" style="max-height: 400px">
		<img #logoDialogImage style="max-width: 100%">
	</div>
</dav-dialog>

<dav-dialog
	[header]="locale.editProfileDialog.header"
	[primaryButtonText]="locale.save"
	[defaultButtonText]="locale.cancel"
	[visible]="editProfileDialogVisible"
	(dismiss)="editProfileDialogVisible = false"
	(primaryButtonClick)="SaveProfile()"
	(defaultButtonClick)="editProfileDialogVisible = false">

	<form>
		<!-- Name -->
		<div class="mb-3">
			<dav-textfield
				[value]="editProfileDialogName"
				[label]="locale.editProfileDialog.nameTextfieldLabel"
				[placeholder]="locale.editProfileDialog.nameTextfieldPlaceholder"
				[errorMessage]="editProfileDialogNameError"
				(change)="editProfileDialogName = $event.detail.value; editProfileDialogNameError = ''"
				(enter)="SaveProfile()">
			</dav-textfield>
		</div>

		<!-- Website url -->
		<div class="mb-3">
			<dav-textfield
				[value]="editProfileDialogWebsiteUrl"
				[label]="locale.editProfileDialog.websiteUrlTextfieldLabel"
				[placeholder]="locale.editProfileDialog.websiteUrlTextfieldPlaceholder"
				type="url"
				autocomplete="url"
				[errorMessage]="editProfileDialogWebsiteUrlError"
				(change)="editProfileDialogWebsiteUrl = $event.detail.value; editProfileDialogWebsiteUrlError = ''"
				(enter)="SaveProfile()">
			</dav-textfield>
		</div>

		<!-- Facebook username -->
		<div class="mb-3">
			<dav-textfield
				[value]="editProfileDialogFacebookUsername"
				[label]="locale.editProfileDialog.facebookUsernameTextfieldLabel"
				[placeholder]="locale.editProfileDialog.facebookUsernameTextfieldPlaceholder"
				autocomplete="username"
				[errorMessage]="editProfileDialogFacebookUsernameError"
				(change)="editProfileDialogFacebookUsername = $event.detail.value; editProfileDialogFacebookUsernameError = ''"
				(enter)="SaveProfile()">
			</dav-textfield>
		</div>

		<!-- Instagram username -->
		<div class="mb-3">
			<dav-textfield
				[value]="editProfileDialogInstagramUsername"
				[label]="locale.editProfileDialog.instagramUsernameTextfieldLabel"
				[placeholder]="locale.editProfileDialog.instagramUsernameTextfieldPlaceholder"
				autocomplete="username"
				[errorMessage]="editProfileDialogInstagramUsernameError"
				(change)="editProfileDialogInstagramUsername = $event.detail.value; editProfileDialogInstagramUsernameError = ''"
				(enter)="SaveProfile()">
			</dav-textfield>
		</div>

		<!-- Twitter username -->
		<div class="mb-3">
			<dav-textfield
				[value]="editProfileDialogTwitterUsername"
				[label]="locale.editProfileDialog.twitterUsernameTextfieldLabel"
				[placeholder]="locale.editProfileDialog.twitterUsernameTextfieldPlaceholder"
				autocomplete="username"
				[errorMessage]="editProfileDialogTwitterUsernameError"
				(change)="editProfileDialogTwitterUsername = $event.detail.value; editProfileDialogTwitterUsernameError = ''"
				(enter)="SaveProfile()">
			</dav-textfield>
		</div>
	</form>
</dav-dialog>

<dav-dialog
	[header]="locale.createAuthorDialog.header"
	[primaryButtonText]="locale.create"
	[defaultButtonText]="locale.cancel"
	[visible]="createAuthorDialogVisible"
	[loading]="createAuthorDialogLoading"
	maxWidth="340"
	(dismiss)="createAuthorDialogVisible = false"
	(primaryButtonClick)="CreateAuthor()"
	(defaultButtonClick)="createAuthorDialogVisible = false">

	<form>
		<!-- First name -->
		<div class="mb-3">
			<dav-textfield
				[value]="createAuthorDialogFirstName"
				[label]="locale.createAuthorDialog.firstNameTextfieldLabel"
				[placeholder]="locale.createAuthorDialog.firstNameTextfieldPlaceholder"
				autocomplete="given-name"
				[disabled]="createAuthorDialogLoading"
				[errorMessage]="createAuthorDialogFirstNameError"
				(change)="createAuthorDialogFirstName = $event.detail.value; createAuthorDialogFirstNameError = ''">
			</dav-textfield>
		</div>

		<!-- Last name -->
		<div class="mb-3">
			<dav-textfield
				[value]="createAuthorDialogLastName"
				[label]="locale.createAuthorDialog.lastNameTextfieldLabel"
				[placeholder]="locale.createAuthorDialog.lastNameTextfieldPlaceholder"
				autocomplete="family-name"
				[disabled]="createAuthorDialogLoading"
				[errorMessage]="createAuthorDialogLastNameError"
				(change)="createAuthorDialogLastName = $event.detail.value; createAuthorDialogLastNameError = ''"
				(enter)="CreateAuthor()">
			</dav-textfield>
		</div>
	</form>
</dav-dialog>